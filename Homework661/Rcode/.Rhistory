power2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(95)
n1.2 <- function(x) pnorm(sqrt(1)*x- za2 )
n4.2 <- function(x) pnorm(sqrt(4)*x- za2 )
n16.2 <- function(x) pnorm(sqrt(16)*x- za2 )
n64.2 <- function(x) pnorm(sqrt(64)*x- za2 )
n100.2 <- function(x) pnorm(sqrt(100)*x- za2 )
power2=p +
stat_function(
fun= n1.2,color="blue"
) +
stat_function(
fun = n4.2,color="black"
) +
stat_function(
fun = n16.2,color="red"
) +
stat_function(
fun = n64.2,color="green"
) +
stat_function(
fun = n100.2,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(95)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power2
za <- qnorm(.95)
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
n1 <- function(x) pnorm(sqrt(1)*x- za )
n4 <- function(x) pnorm(sqrt(4)*x- za )
n16 <- function(x) pnorm(sqrt(16)*x- za )
n64 <- function(x) pnorm(sqrt(64)*x- za )
n100 <- function(x) pnorm(sqrt(100)*x- za )
power1=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power1
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power2
qnorm(1-.975)
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power2
c1<-qnorm(0.025,p,sd)
c2<-qnorm(0.975,p,sd)
c1<-qnorm(0.025)
c2<-qnorm(0.975)
c1
c2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+1-pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power2
pnorm(.025)
qnorm(.025)
a=qnomr(.025)
a=qnorm(.025)
b=qnorm(.975)
pnorm(a)+1-pnorm(b)
pnorm(a)
pnorm(b)
1-pnorm(b)
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+1-pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(-1, 1))+xlab(expression(theta))+ylab("Power")
power2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+1-pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )+1-pnorm(sqrt(14)*x- za3 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )+1-pnorm(sqrt(16)*x- za3 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )+1-pnorm(sqrt(64)*x- za3 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )+1-pnorm(sqrt(100)*x- za3 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(-1, 1))+xlab(expression(theta))+ylab("Power")
power2
za <- qnorm(.95)
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
n1 <- function(x) pnorm(sqrt(1)*x- za )
n4 <- function(x) pnorm(sqrt(4)*x- za )
n16 <- function(x) pnorm(sqrt(16)*x- za )
n64 <- function(x) pnorm(sqrt(64)*x- za )
n100 <- function(x) pnorm(sqrt(100)*x- za )
power1=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(-1, 1))+xlab(expression(theta))+ylab("Power")
power1
za <- qnorm(.95)
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
n1 <- function(x) pnorm(sqrt(1)*x- za )
n4 <- function(x) pnorm(sqrt(4)*x- za )
n16 <- function(x) pnorm(sqrt(16)*x- za )
n64 <- function(x) pnorm(sqrt(64)*x- za )
n100 <- function(x) pnorm(sqrt(100)*x- za )
power1=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(0, 1))+xlab(expression(theta))+ylab("Power")
power1
ggsave(file="power2.png",plot=power2)
ggsave(file="power2.png",plot=power2,height=5,width=7)
betavals<-c(rep(9,50))
for( i in 1:50){
myq<-qgamma(shape = i, scale = 1, p=.99)
betavals[i]<-pgamma(shape = i , scale = 2, q = myq)
}
which(betavals<0.01)
myq
betavals<-c(rep(9,50))
for( i in 1:50){
myq<-qgamma(shape = i, scale = 1, p=.99)
betavals[i]<-pgamma(shape = i , scale = 2, q = myq)
}
betavals
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+1-pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )+1-pnorm(sqrt(14)*x- za3 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )+1-pnorm(sqrt(16)*x- za3 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )+1-pnorm(sqrt(64)*x- za3 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )+1-pnorm(sqrt(100)*x- za3 )
power2=p +
stat_function(
fun= n1,color="blue",size=2
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(-1, 1))+xlab(expression(theta))+ylab("Power")
power2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+1-pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )+1-pnorm(sqrt(14)*x- za3 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )+1-pnorm(sqrt(16)*x- za3 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )+1-pnorm(sqrt(64)*x- za3 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )+1-pnorm(sqrt(100)*x- za3 )
power2=p +
stat_function(
fun= n1,color="blue",size=1.25
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(-1, 1))+xlab(expression(theta))+ylab("Power")
power2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+1-pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )+1-pnorm(sqrt(14)*x- za3 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )+1-pnorm(sqrt(16)*x- za3 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )+1-pnorm(sqrt(64)*x- za3 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )+1-pnorm(sqrt(100)*x- za3 )
power2=p +
stat_function(
fun= n1,color="blue",size=1.05
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(-1, 1))+xlab(expression(theta))+ylab("Power")
power2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
za2=qnorm(.975)
za3=qnorm(1-.975)
n1 <- function(x) pnorm(sqrt(1)*x- za2 )+1-pnorm(sqrt(1)*x- za3 )
n4 <- function(x) pnorm(sqrt(4)*x- za2 )+1-pnorm(sqrt(14)*x- za3 )
n16 <- function(x) pnorm(sqrt(16)*x- za2 )+1-pnorm(sqrt(16)*x- za3 )
n64 <- function(x) pnorm(sqrt(64)*x- za2 )+1-pnorm(sqrt(64)*x- za3 )
n100 <- function(x) pnorm(sqrt(100)*x- za2 )+1-pnorm(sqrt(100)*x- za3 )
power2=p +
stat_function(
fun= n1,color="blue"
) +
stat_function(
fun = n4,color="black"
) +
stat_function(
fun = n16,color="red"
) +
stat_function(
fun = n64,color="green"
) +
stat_function(
fun = n100,color="orange"
)+
scale_x_continuous(limits = c(-1, 1))+xlab(expression(theta))+ylab("Power")
power2
m="j"
fu.str(j)=d
fu.str(j)=1
fu.str(m)=1
lhs <- rnorm(10)
rhs <- paste("perf.a", 1:10, "<-", lhs, sep="")
eval(parse(text=rhs))
lhs <- rnorm(10)
rhs <- paste("perf.", 1:10, "<-", lhs, sep="")
eval(parse(text=rhs))
perf.1
rm(ls())
rm(list=ls())
source('~/Bios661/Homework/Rcode/cfun_function.R')
source('~/Bios661/Homework/Rcode/cfun_function.R')
cfun(3)
fun=5
cfun(fun,4)
cfun(fun,n=4)
source('~/Bios661/Homework/Rcode/cfun_function.R')
cfun(fun,n=4)
fun
fun=rnorm(4)
cfun(fun,n=4)
cfun
source('~/Bios661/Homework/Rcode/cfun_function.R')
cfun(fun,n=4)
source('~/Bios661/Homework/Rcode/cfun_function.R')
cfun(fun,4)
fun
n=1:4
fun.1=function(x) n*x
fun.1
function(x) zb*x
fun.1=function(x) zb*x
zb=c(1,2,3)
fun.1
zb=1
n=1:4
for (i in n) {
zb=i
}
zb
d=function(x,n) n*x
d
n=1
d
d(1)
d(1,2)
y=seq(0,1,0.01)
d(y,4)
rnorm(3)
vals <- c(1,4,16,64,100)
n    <- length(vals)
lhs  <- paste("fun",    1:n,     sep="")
rhs  <- paste("vals[",1:n,"]", sep="")
eq   <- paste(paste(lhs, rhs, sep="<-"), collapse=";")
eval(parse(text=eq))
for(i in 1:3){
assign(paste("a", i, sep = ""), i)
}
a1
a2
for(i in c(1,4,16,64,100)){
assign(paste("a", function(x) pnorm(sqrt(i)*x-qnorm(.95)), sep = ""), i)
}
for(i in c(1,4,16,64,100)){
assign(paste("a", function(x) i, sep = ""), pnorm(sqrt(i)*x-qnorm(.95)))
}
n = 10
p = 0.5
a=.377
sd = sqrt((p * (1 - p)/n))
c1<-qnorm(a/2,p,sd)
c2<-qnorm(1-a/2,p,sd)
p_hat_seq = seq(0, 1, 0.01)
power<-1-pnorm(c2,p_hat_seq,sd)
d=plot(p_hat_seq, power, type = "l",xlab=expr(theta), ylab = "Power" )
source('~/Bios661/Homework/Rcode/binpwr.R')
fun.1=function(x) -x^2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
p+stat_function(fun=fun.1)+ xlim(-10,10)+theme_bw()+
theme(axis.title.y=element_blank() ,axis.text.x=element_blank(),axis.text.y=element_blank())
library(tidyverse)
fun.1=function(x) -x^2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
p+stat_function(fun=fun.1)+ xlim(-10,10)+theme_bw()+
theme(axis.title.y=element_blank() ,axis.text.x=element_blank(),axis.text.y=element_blank())
fun.1=function(x) -x^2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
p+stat_function(fun=fun.1)+ xlim(-10,10)+theme_bw()+
theme(axis.title.y=element_blank() ,axis.text.x=element_blank(),axis.text.y=element_blank())
fun.1=function(x) -x^2
p <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
p+stat_function(fun=fun.1)+ xlim(-10,10)+theme_bw()+
theme(axis.title.y=element_blank(),axis.title.x=element_blank() ,axis.text.x=element_blank(),axis.text.y=element_blank())
